{% comment %}
  Custom Banner (from scratch) — COLLAGE VERSION
  - Text sits on top of a collage of many small images (each image is a block you can position)
  - All red-rectangle texts are editable (eyebrow, 3-part heading, subheading, buttons, caption, disclaimer)
  - Adjustable dark overlay for readability
  - Mobile + desktop positions for each image layer
  - No Dawn components, no jQuery
{% endcomment %}
<section id="custom-banner-{{ section.id }}" class="c-banner c-banner--{{ section.settings.align }}"
  style="--content-max: {{ section.settings.max_width }}px; --text: {{ section.settings.text_color }}; --overlay: {{ section.settings.overlay_opacity | divided_by: 100.0 }};"
  data-shine="{{ section.settings.enable_shine }}">
  {% if section.settings.bg_image != blank %}
    <div class="c-banner__bg" style="--bg:url({{ section.settings.bg_image | img_url: 'master' }});"></div>
  {% endif %}

  {%- comment -%} Collage of many small images — each block is an absolute-positioned layer {%- endcomment -%}
  <div class="c-banner__collage" aria-hidden="true">
    {% for block in section.blocks %}
      {% if block.type == 'image_layer' and block.settings.img != blank %}
        <div class="c-layer{% if block.settings.hide_mobile %} is-mobile-hidden{% endif %}"
          style="
            --l: {{ block.settings.d_left }}%;
            --t: {{ block.settings.d_top }}%;
            --w: {{ block.settings.d_width }}%;
            --ml: {{ block.settings.m_left }}%;
            --mt: {{ block.settings.m_top }}%;
            --mw: {{ block.settings.m_width }}%;
            --r: {{ block.settings.rotate }}deg;
            --z: {{ block.settings.z_index }};
            --o: {{ block.settings.opacity | divided_by: 100.0 }};">
          <img src="{{ block.settings.img | img_url: 'master' }}" alt="" loading="lazy" decoding="async">
        </div>
      {% endif %}
    {% endfor %}
  </div>

  {%- comment -%} Shade overlay sits above bg+collage but below text {%- endcomment -%}
  <div class="c-banner__shade" aria-hidden="true"></div>

  <div class="c-banner__inner">
    {% if section.settings.eyebrow != blank %}
      <p class="c-banner__tag">{{ section.settings.eyebrow }}</p>
    {% endif %}

    <h1 class="c-banner__title">
      {% if section.settings.heading_line_1 != blank %}
        <span class="c-banner__line1">{{ section.settings.heading_line_1 }}</span>
      {% endif %}
      {% if section.settings.heading_highlight != blank %}
        <span class="c-banner__hl">{{ section.settings.heading_highlight }}</span>
      {% endif %}
      {% if section.settings.heading_line_2 != blank %}
        <span class="c-banner__line2">{{ section.settings.heading_line_2 }}</span>
      {% endif %}
    </h1>

    {% if section.settings.subheading != blank %}
      <div class="c-banner__subtitle">{{ section.settings.subheading }}</div>
    {% endif %}

    <div class="c-banner__cta">
      {% if section.settings.cta1_label != blank %}
        <a class="c-btn c-btn--shine" href="{{ section.settings.cta1_link | default: '#' }}" data-anim-btn>
          {{ section.settings.cta1_label }}
        </a>
      {% endif %}
      {% if section.settings.cta2_label != blank %}
        <a class="c-btn c-btn--outline c-btn--shine" href="{{ section.settings.cta2_link | default: '#' }}" data-anim-btn>
          {{ section.settings.cta2_label }}
        </a>
      {% endif %}
    </div>

    {% if section.settings.caption != blank %}
      <p class="c-banner__caption">{{ section.settings.caption }}</p>
    {% endif %}
    {% if section.settings.disclaimer != blank %}
      <p class="c-banner__disc">{{ section.settings.disclaimer }}</p>
    {% endif %}
  </div>
</section>

<style>
  .c-banner{position:relative;overflow:hidden;isolation:isolate;min-height:68vh;display:grid;place-items:center;
    padding:clamp(20px,4vw,64px);color:var(--text,#ffffff)}

  /* Layers order: bg (-3) → collage (-2) → shade (-1) → text (0) */
  .c-banner__bg{position:absolute;inset:0;background-image:var(--bg);background-size:cover;background-position:center;z-index:-3}
  .c-banner__collage{position:absolute;inset:0;z-index:-2;pointer-events:none}
  .c-banner__shade{position:absolute;inset:0;background:rgba(0,0,0,var(--overlay,0.35));z-index:-1}

  .c-layer{position:absolute;left:var(--l);top:var(--t);width:var(--w);transform:rotate(var(--r));z-index:var(--z);opacity:var(--o)}
  .c-layer img{display:block;width:100%;height:auto}
  @media (max-width: 640px){
    .c-layer{left:var(--ml);top:var(--mt);width:var(--mw)}
    .c-layer.is-mobile-hidden{display:none}
  }

  .c-banner__inner{max-width:var(--content-max,1000px);width:100%}
  .c-banner--center .c-banner__inner{margin-inline:auto;text-align:center}
  .c-banner--left .c-banner__inner{margin-inline:auto 0;text-align:left}
  .c-banner--right .c-banner__inner{margin-inline:0 auto;text-align:right}

  .c-banner__tag{letter-spacing:.14em;text-transform:uppercase;font-weight:600;margin:0 0 .5rem;opacity:.95}
  .c-banner__title{font-size:clamp(30px,6vw,64px);line-height:1.1;margin:.25rem 0 1rem;font-weight:800;word-break:break-word}
  .c-banner__hl{padding:.05em .25em;border-radius:.35em;box-shadow:inset 0 -0.5em 0 rgba(255,205,0,.45)}
  .c-banner__subtitle{font-size:clamp(16px,2.2vw,20px);opacity:.98;max-width:80ch;margin:0 0 1.25rem}
  .c-banner__cta{display:flex;gap:12px;flex-wrap:wrap;justify-content:inherit;margin-bottom:.75rem}
  .c-banner__caption{opacity:.95;margin:.25rem 0 0}
  .c-banner__disc{opacity:.8;font-size:.9rem;margin:.25rem 0 0}

  .c-btn{position:relative;display:inline-flex;align-items:center;justify-content:center;padding:.9rem 1.25rem;border-radius:999px;
    background:#111;color:#fff;border:2px solid #111;font-weight:700;text-decoration:none;transition:transform .2s ease}
  .c-btn--outline{background:transparent;color:var(--text,#fff);border-color:currentColor}
  .c-btn:hover{transform:translateY(-1px)}

  .c-btn--shine{overflow:hidden}
  .c-banner[data-shine="false"] .c-btn--shine::after{animation:none}
  .c-btn--shine::after{content:"";position:absolute;inset:-150% auto -150% -50%;width:40%;transform:rotate(25deg);
    background:linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,.35) 50%, rgba(255,255,255,0) 100%);
    animation:shine 3.6s linear infinite}
  @keyframes shine{0%{left:-60%}100%{left:160%}}

  @media (max-width: 640px){
    .c-banner{min-height:56vh;padding:clamp(16px,5vw,28px)}
    .c-banner__title{font-size:clamp(26px,8vw,40px)}
    .c-banner__subtitle{font-size:clamp(14px,4vw,18px)}
    .c-banner__cta{justify-content:center}
  }
</style>

{% schema %}
{
  "name": "Custom Banner",
  "settings": [
    { "type": "text", "id": "eyebrow", "label": "Eyebrow / Tagline", "default": "NEW ARRIVALS" },

    { "type": "text", "id": "heading_line_1", "label": "Heading – Line 1", "default": "Winter" },
    { "type": "text", "id": "heading_highlight", "label": "Heading – Highlight (middle)", "default": "Season" },
    { "type": "text", "id": "heading_line_2", "label": "Heading – Line 2", "default": "Essentials" },

    { "type": "richtext", "id": "subheading", "label": "Subheading (rich text)",
      "default": "<p>Cozy layers, clean silhouettes and everyday comfort—built for chilly mornings and late-night walks.</p>" },

    { "type": "text", "id": "cta1_label", "label": "Primary Button Label", "default": "Shop Now" },
    { "type": "url",  "id": "cta1_link",  "label": "Primary Button Link" },

    { "type": "text", "id": "cta2_label", "label": "Secondary Button Label", "default": "Learn More" },
    { "type": "url",  "id": "cta2_link",  "label": "Secondary Button Link" },

    { "type": "text", "id": "caption", "label": "Small caption under buttons" },
    { "type": "text", "id": "disclaimer", "label": "Tiny disclaimer" },

    { "type": "image_picker", "id": "bg_image", "label": "(Optional) Background image behind collage" },
    { "type": "range", "id": "overlay_opacity", "label": "Dark overlay opacity", "min": 0, "max": 90, "step": 5, "unit": "%", "default": 35 },

    { "type": "select", "id": "align", "label": "Content alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },

    { "type": "range", "id": "max_width", "label": "Content max width", "min": 480, "max": 1200, "step": 20, "unit": "px", "default": 1000 },
    { "type": "color", "id": "text_color", "label": "Text color", "default": "#ffffff" },
    { "type": "checkbox", "id": "enable_shine", "label": "Enable button shine animation", "default": true }
  ],
  "blocks": [
    {
      "type": "image_layer",
      "name": "Image layer",
      "settings": [
        { "type": "image_picker", "id": "img", "label": "Image" },
        { "type": "range", "id": "d_left", "label": "Desktop left (%)", "min": 0, "max": 100, "step": 1, "default": 10 },
        { "type": "range", "id": "d_top", "label": "Desktop top (%)", "min": 0, "max": 100, "step": 1, "default": 10 },
        { "type": "range", "id": "d_width", "label": "Desktop width (%)", "min": 5, "max": 90, "step": 1, "default": 20 },

        { "type": "range", "id": "m_left", "label": "Mobile left (%)", "min": 0, "max": 100, "step": 1, "default": 10 },
        { "type": "range", "id": "m_top", "label": "Mobile top (%)", "min": 0, "max": 100, "step": 1, "default": 10 },
        { "type": "range", "id": "m_width", "label": "Mobile width (%)", "min": 10, "max": 100, "step": 1, "default": 40 },

        { "type": "range", "id": "rotate", "label": "Rotation (deg)", "min": -45, "max": 45, "step": 1, "default": 0 },
        { "type": "range", "id": "opacity", "label": "Opacity (%)", "min": 10, "max": 100, "step": 5, "default": 100 },
        { "type": "range", "id": "z_index", "label": "Layer order (z-index)", "min": 1, "max": 20, "step": 1, "default": 5 },
        { "type": "checkbox", "id": "hide_mobile", "label": "Hide on mobile", "default": false }
      ]
    }
  ],
  "max_blocks": 24,
  "presets": [
    { "name": "Custom Banner", "blocks": [
      {"type":"image_layer"}, {"type":"image_layer"}, {"type":"image_layer"}
    ]}
  ]
}
{% endschema %}