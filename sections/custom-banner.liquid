{% comment %}
  Custom Banner (from scratch) — Collage + Asset Fallbacks
  - Text sits over a collage of many small images (each is a block)
  - Each block can use either an uploaded image OR an asset filename from /assets
  - All copy is editable; layout/colors via CSS (custom-landing.css)
  - No inline styles except CSS variables from settings
{% endcomment %}
<section id="custom-banner-{{ section.id }}"
  class="c-banner c-banner--{{ section.settings.align }}"
  style="
    --content-max: {{ section.settings.max_width }}px;
    --text: {{ section.settings.text_color }};
    --overlay: {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    {% if section.settings.bg_image != blank %}--bg:url({{ section.settings.bg_image | img_url: 'master' }});{% endif %}
  "
  data-shine="{{ section.settings.enable_shine }}"
>

  {%- comment -%} Background image (optional) {%- endcomment -%}
  {% if section.settings.bg_image != blank %}
    <div class="c-banner__bg" aria-hidden="true"></div>
  {% endif %}

  {%- comment -%} Collage layers (absolute-positioned) {%- endcomment -%}
  <div class="c-banner__collage" aria-hidden="true">
    {% for block in section.blocks %}
      {% if block.type == 'image_layer' %}
        {% assign src = '' %}
        {% if block.settings.img != blank %}
          {% assign src = block.settings.img | img_url: 'master' %}
        {% elsif block.settings.asset != blank %}
          {% assign src = block.settings.asset | asset_url %}
        {% endif %}
        {% if src != '' %}
        <div class="c-layer{% if block.settings.hide_mobile %} is-mobile-hidden{% endif %}"
          style="
            --l: {{ block.settings.d_left }}%;
            --t: {{ block.settings.d_top }}%;
            --w: {{ block.settings.d_width }}%;
            --ml: {{ block.settings.m_left }}%;
            --mt: {{ block.settings.m_top }}%;
            --mw: {{ block.settings.m_width }}%;
            --r: {{ block.settings.rotate }}deg;
            --z: {{ block.settings.z_index }};
            --o: {{ block.settings.opacity | divided_by: 100.0 }};
          ">
          <img src="{{ src }}" alt="{{ block.settings.alt | escape }}" loading="lazy" decoding="async">
        </div>
        {% endif %}
      {% endif %}
    {% endfor %}
  </div>

  <div class="c-banner__shade" aria-hidden="true"></div>

  <div class="c-banner__inner">
    {% if section.settings.eyebrow != blank %}
      <p class="c-banner__tag">{{ section.settings.eyebrow }}</p>
    {% endif %}

    <h1 class="c-banner__title">
      {% if section.settings.heading_line_1 != blank %}
        <span class="c-banner__line1">{{ section.settings.heading_line_1 }}</span>
      {% endif %}
      {% if section.settings.heading_highlight != blank %}
        <span class="c-banner__hl">{{ section.settings.heading_highlight }}</span>
      {% endif %}
      {% if section.settings.heading_line_2 != blank %}
        <span class="c-banner__line2">{{ section.settings.heading_line_2 }}</span>
      {% endif %}
    </h1>

    {% if section.settings.subheading != blank %}
      <div class="c-banner__subtitle">{{ section.settings.subheading }}</div>
    {% endif %}

    <div class="c-banner__cta">
      {% if section.settings.cta1_label != blank %}
        <a class="c-btn c-btn--shine" href="{{ section.settings.cta1_link | default: '#' }}" data-anim-btn>
          {{ section.settings.cta1_label }}
        </a>
      {% endif %}
      {% if section.settings.cta2_label != blank %}
        <a class="c-btn c-btn--outline c-btn--shine" href="{{ section.settings.cta2_link | default: '#' }}" data-anim-btn>
          {{ section.settings.cta2_label }}
        </a>
      {% endif %}
    </div>

    {% if section.settings.caption != blank %}
      <p class="c-banner__caption">{{ section.settings.caption }}</p>
    {% endif %}
    {% if section.settings.disclaimer != blank %}
      <p class="c-banner__disc">{{ section.settings.disclaimer }}</p>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Custom Banner",
  "settings": [
    { "type": "text", "id": "eyebrow", "label": "Eyebrow / Tagline", "default": "The Gift Guide" },

    { "type": "text", "id": "heading_line_1", "label": "Heading – Line 1", "default": "The Gift" },
    { "type": "text", "id": "heading_highlight", "label": "Heading – Highlight (middle)", "default": "Guide" },
    { "type": "text", "id": "heading_line_2", "label": "Heading – Line 2", "default": "" },

    { "type": "richtext", "id": "subheading", "label": "Subheading (rich text)",
      "default": "<p>Discover Joy: Your Ultimate Holiday Gift Destination.</p><p>Explore our curated selection and find the perfect gifts to delight your loved ones this holiday season.</p>" },

    { "type": "text", "id": "cta1_label", "label": "Primary Button Label", "default": "SHOP NOW" },
    { "type": "url",  "id": "cta1_link",  "label": "Primary Button Link" },

    { "type": "text", "id": "cta2_label", "label": "Secondary Button Label", "default": "" },
    { "type": "url",  "id": "cta2_link",  "label": "Secondary Button Link" },

    { "type": "text", "id": "caption", "label": "Caption under buttons", "default": "SUSTAINABLE, ETHICALLY MADE ACTIVEWEAR" },
    { "type": "text", "id": "disclaimer", "label": "Tiny disclaimer", "default": "" },

    { "type": "image_picker", "id": "bg_image", "label": "(Optional) Background image behind collage" },
    { "type": "range", "id": "overlay_opacity", "label": "Dark overlay opacity", "min": 0, "max": 90, "step": 5, "unit": "%", "default": 20 },

    { "type": "select", "id": "align", "label": "Content alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },

    { "type": "range", "id": "max_width", "label": "Content max width", "min": 480, "max": 1200, "step": 20, "unit": "px", "default": 1000 },
    { "type": "color", "id": "text_color", "label": "Text color", "default": "#111111" },
    { "type": "checkbox", "id": "enable_shine", "label": "Enable button shine animation", "default": true }
  ],

  "blocks": [
    {
      "type": "image_layer",
      "name": "Image layer",
      "settings": [
        { "type": "image_picker", "id": "img", "label": "Image (upload to override asset filename)" },
        { "type": "text", "id": "asset", "label": "Asset filename from /assets (e.g. collage-camera.svg)", "default": "" },
        { "type": "text", "id": "alt", "label": "Alt text", "default": "" },

        { "type": "range", "id": "d_left", "label": "Desktop left (%)", "min": 0, "max": 100, "step": 1, "default": 10 },
        { "type": "range", "id": "d_top", "label": "Desktop top (%)", "min": 0, "max": 100, "step": 1, "default": 10 },
        { "type": "range", "id": "d_width", "label": "Desktop width (%)", "min": 5, "max": 90, "step": 1, "default": 20 },

        { "type": "range", "id": "m_left", "label": "Mobile left (%)", "min": 0, "max": 100, "step": 1, "default": 10 },
        { "type": "range", "id": "m_top", "label": "Mobile top (%)", "min": 0, "max": 100, "step": 1, "default": 10 },
        { "type": "range", "id": "m_width", "label": "Mobile width (%)", "min": 10, "max": 100, "step": 1, "default": 40 },

        { "type": "range", "id": "rotate", "label": "Rotation (deg)", "min": -45, "max": 45, "step": 1, "default": 0 },
        { "type": "range", "id": "opacity", "label": "Opacity (%)", "min": 10, "max": 100, "step": 5, "default": 100 },
        { "type": "range", "id": "z_index", "label": "Layer order (z-index)", "min": 1, "max": 20, "step": 1, "default": 5 },
        { "type": "checkbox", "id": "hide_mobile", "label": "Hide on mobile", "default": false }
      ]
    }
  ],

  "max_blocks": 24,
  "presets": [{ "name": "Custom Banner", "blocks": [{ "type": "image_layer" }] }]
}
{% endschema %}
